parcelRequire=function(e,r,t,n){var i,o="function"==typeof parcelRequire&&parcelRequire,u="function"==typeof require&&require;function f(t,n){if(!r[t]){if(!e[t]){var i="function"==typeof parcelRequire&&parcelRequire;if(!n&&i)return i(t,!0);if(o)return o(t,!0);if(u&&"string"==typeof t)return u(t);var c=new Error("Cannot find module '"+t+"'");throw c.code="MODULE_NOT_FOUND",c}p.resolve=function(r){return e[t][1][r]||r},p.cache={};var l=r[t]=new f.Module(t);e[t][0].call(l.exports,p,l,l.exports,this)}return r[t].exports;function p(e){return f(p.resolve(e))}}f.isParcelRequire=!0,f.Module=function(e){this.id=e,this.bundle=f,this.exports={}},f.modules=e,f.cache=r,f.parent=o,f.register=function(r,t){e[r]=[function(e,r){r.exports=t},{}]};for(var c=0;c<t.length;c++)try{f(t[c])}catch(e){i||(i=e)}if(t.length){var l=f(t[t.length-1]);"object"==typeof exports&&"undefined"!=typeof module?module.exports=l:"function"==typeof define&&define.amd?define(function(){return l}):n&&(this[n]=l)}if(parcelRequire=f,i)throw i;return f}({"k3Ah":[function(require,module,exports) {
"use strict";const t=-8,r=-4,n=0,e=1,a=2,i=1,o=2,l=4,u=8,s=5,y=1<<s,c=1024,f=2048,A=4096,b=8192,g=14,_=1<<g,p=1<<19,w=1<<20,d=1<<21,m=1<<22,h=0,U=4,I=8,O=12,j=12,v=16,S="undefined"!=typeof BigUint64Array,V=Symbol(),C=1024;function F(t,n){const e=new Uint32Array(t),a=new Uint16Array(t);var i=e[n+r>>>2]>>>1,o=n>>>1;if(i<=C)return String.fromCharCode.apply(String,a.subarray(o,o+i));const l=[];do{const t=a[o+C-1],r=t>=55296&&t<56320?C-1:C;l.push(String.fromCharCode.apply(String,a.subarray(o,o+=r))),i-=r}while(i>C);return l.join("")+String.fromCharCode.apply(String,a.subarray(o,o+i))}function B(t){const r={};function n(t,r){return t?F(t.buffer,r):"<yet unknown>"}const e=t.env=t.env||{};return e.abort=e.abort||function(t,a,i,o){const l=r.memory||e.memory;throw Error("abort: "+n(l,t)+" at "+n(l,a)+":"+i+":"+o)},e.trace=e.trace||function(t,a){const i=r.memory||e.memory;console.log("trace: "+n(i,t)+(a?" ":"")+Array.prototype.slice.call(arguments,2,2+a).join(", "))},t.Math=t.Math||Math,t.Date=t.Date||Date,r}function P(a,l){const u=l.exports,y=u.memory,A=u.table,g=u.__alloc,_=u.__retain,p=u.__rtti_base||-1;function w(t){const r=new Uint32Array(y.buffer);if((t>>>=0)>=r[p>>>2])throw Error("invalid id: "+t);return r[(p+4>>>2)+2*t]}function d(t){const r=new Uint32Array(y.buffer);if((t>>>=0)>=r[p>>>2])throw Error("invalid id: "+t);return r[(p+4>>>2)+2*t+1]}function m(t){return 31-Math.clz32(t>>>s&31)}function V(t,r,n){const e=y.buffer;if(n)switch(t){case 2:return new Float32Array(e);case 3:return new Float64Array(e)}else switch(t){case 0:return new(r?Int8Array:Uint8Array)(e);case 1:return new(r?Int16Array:Uint16Array)(e);case 2:return new(r?Int32Array:Uint32Array)(e);case 3:return new(r?BigInt64Array:BigUint64Array)(e)}throw Error("unsupported align: "+t)}function C(n){const e=new Uint32Array(y.buffer),a=e[n+t>>>2],l=w(a);if(!(l&i))throw Error("not an array: "+a);const u=m(l);var s=e[n+U>>>2];const A=l&o?e[n+j>>>2]:e[s+r>>>2]>>>u;return V(u,l&c,l&f).subarray(s>>>=u,s+A)}function B(t,r,n){return new t(P(t,r,n))}function P(t,n,e){const a=y.buffer,i=new Uint32Array(a),o=i[e+U>>>2];return new t(a,o,i[o+r>>>2]>>>n)}return a.__allocString=function(t){const r=t.length,n=g(r<<1,e),a=new Uint16Array(y.buffer);for(var i=0,o=n>>>1;i<r;++i)a[o+i]=t.charCodeAt(i);return n},a.__getString=function(r){const n=y.buffer;if(new Uint32Array(n)[r+t>>>2]!==e)throw Error("not a string: "+r);return F(n,r)},a.__allocArray=function(t,r){const e=w(t);if(!(e&(i|o)))throw Error("not an array: "+t+" @ "+e);const a=m(e),l=r.length,u=g(l<<a,n),s=g(e&o?v:O,t),A=new Uint32Array(y.buffer);A[s+h>>>2]=_(u),A[s+U>>>2]=u,A[s+I>>>2]=l<<a,e&o&&(A[s+j>>>2]=l);const p=V(a,e&c,e&f);if(e&b)for(let n=0;n<l;++n)p[(u>>>a)+n]=_(r[n]);else p.set(r,u>>>a);return s},a.__getArrayView=C,a.__getArray=function(t){const r=C(t),n=r.length,e=new Array(n);for(let a=0;a<n;a++)e[a]=r[a];return e},a.__getArrayBuffer=function(t){const n=y.buffer,e=new Uint32Array(n)[t+r>>>2];return n.slice(t,t+e)},a.__getInt8Array=B.bind(null,Int8Array,0),a.__getInt8ArrayView=P.bind(null,Int8Array,0),a.__getUint8Array=B.bind(null,Uint8Array,0),a.__getUint8ArrayView=P.bind(null,Uint8Array,0),a.__getUint8ClampedArray=B.bind(null,Uint8ClampedArray,0),a.__getUint8ClampedArrayView=P.bind(null,Uint8ClampedArray,0),a.__getInt16Array=B.bind(null,Int16Array,1),a.__getInt16ArrayView=P.bind(null,Int16Array,1),a.__getUint16Array=B.bind(null,Uint16Array,1),a.__getUint16ArrayView=P.bind(null,Uint16Array,1),a.__getInt32Array=B.bind(null,Int32Array,2),a.__getInt32ArrayView=P.bind(null,Int32Array,2),a.__getUint32Array=B.bind(null,Uint32Array,2),a.__getUint32ArrayView=P.bind(null,Uint32Array,2),S&&(a.__getInt64Array=B.bind(null,BigInt64Array,3),a.__getInt64ArrayView=P.bind(null,BigInt64Array,3),a.__getUint64Array=B.bind(null,BigUint64Array,3),a.__getUint64ArrayView=P.bind(null,BigUint64Array,3)),a.__getFloat32Array=B.bind(null,Float32Array,2),a.__getFloat32ArrayView=P.bind(null,Float32Array,2),a.__getFloat64Array=B.bind(null,Float64Array,3),a.__getFloat64ArrayView=P.bind(null,Float64Array,3),a.__instanceof=function(r,n){const e=new Uint32Array(y.buffer);var a=e[r+t>>>2];if(a<=e[p>>>2])do{if(a==n)return!0}while(a=d(a));return!1},a.memory=a.memory||y,a.table=a.table||A,D(u,a)}function E(t){return"undefined"!=typeof Response&&t instanceof Response}async function W(t,r){return E(t=await t)?x(t,r):P(B(r||(r={})),await WebAssembly.instantiate(t instanceof WebAssembly.Module?t:await WebAssembly.compile(t),r))}function M(t,r){return P(B(r||(r={})),new WebAssembly.Instance(t instanceof WebAssembly.Module?t:new WebAssembly.Module(t),r))}async function x(t,r){return WebAssembly.instantiateStreaming?P(B(r||(r={})),(await WebAssembly.instantiateStreaming(t,r)).instance):W(E(t=await t)?t.arrayBuffer():t,r)}function D(t,r){var n=r?Object.create(r):{},e=t.__argumentsLength?function(r){t.__argumentsLength.value=r}:t.__setArgumentsLength||t.__setargc||function(){};for(let a in t){if(!Object.prototype.hasOwnProperty.call(t,a))continue;const r=t[a];let i=a.split("."),o=n;for(;i.length>1;){let t=i.shift();Object.prototype.hasOwnProperty.call(o,t)||(o[t]={}),o=o[t]}let l=i[0],u=l.indexOf("#");if(u>=0){let n=l.substring(0,u),i=o[n];if(void 0===i||!i.prototype){let t=function(...r){return t.wrap(t.prototype.constructor(0,...r))};t.prototype={valueOf:function(){return this[V]}},t.wrap=function(r){return Object.create(t.prototype,{[V]:{value:r,writable:!1}})},i&&Object.getOwnPropertyNames(i).forEach(r=>Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(i,r))),o[n]=t}if(l=l.substring(u+1),o=o[n].prototype,/^(get|set):/.test(l)){if(!Object.prototype.hasOwnProperty.call(o,l=l.substring(4))){let r=t[a.replace("set:","get:")],n=t[a.replace("get:","set:")];Object.defineProperty(o,l,{get:function(){return r(this[V])},set:function(t){n(this[V],t)},enumerable:!0})}}else"constructor"===l?(o[l]=((...t)=>(e(t.length),r(...t)))).original=r:(o[l]=function(...t){return e(t.length),r(this[V],...t)}).original=r}else/^(get|set):/.test(l)?Object.prototype.hasOwnProperty.call(o,l=l.substring(4))||Object.defineProperty(o,l,{get:t[a.replace("set:","get:")],set:t[a.replace("get:","set:")],enumerable:!0}):"function"==typeof r&&r!==e?(o[l]=((...t)=>(e(t.length),r(...t)))).original=r:o[l]=r}return n}exports.instantiate=W,exports.instantiateSync=M,exports.instantiateStreaming=x,exports.demangle=D;
},{}],"QCba":[function(require,module,exports) {
"use strict";var e=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))(function(a,i){function o(e){try{u(r.next(e))}catch(t){i(t)}}function c(e){try{u(r.throw(e))}catch(t){i(t)}}function u(e){var t;e.done?a(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(o,c)}u((r=r.apply(e,t||[])).next())})},t=this&&this.__generator||function(e,t){var n,r,a,i,o={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return i={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function c(i){return function(c){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,r&&(a=2&i[0]?r.return:i[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,i[1])).done)return a;switch(r=0,a&&(i=[2&i[0],a.value]),i[0]){case 0:case 1:a=i;break;case 4:return o.label++,{value:i[1],done:!1};case 5:o.label++,r=i[1],i=[0];continue;case 7:i=o.ops.pop(),o.trys.pop();continue;default:if(!(a=(a=o.trys).length>0&&a[a.length-1])&&(6===i[0]||2===i[0])){o=0;continue}if(3===i[0]&&(!a||i[1]>a[0]&&i[1]<a[3])){o.label=i[1];break}if(6===i[0]&&o.label<a[1]){o.label=a[1],a=i;break}if(a&&o.label<a[2]){o.label=a[2],o.ops.push(i);break}a[2]&&o.ops.pop(),o.trys.pop();continue}i=t.call(e,o)}catch(c){i=[6,c],r=0}finally{n=a=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,c])}}},n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(exports,"__esModule",{value:!0});var r=n(require("@assemblyscript/loader"));window.OffscreenCanvas||(window.OffscreenCanvas=function(){return function(e,t){var n=this;return this.canvas=document.createElement("canvas"),this.canvas.width=e,this.canvas.height=t,this.canvas.convertToBlob=function(){return new Promise(function(e){n.canvas.toBlob(e)})},this.canvas}}());var a=function(){return e(void 0,void 0,void 0,function(){return t(this,function(e){switch(e.label){case 0:return[4,r.default.instantiate(fetch("optimized.wasm"))];case 1:return[2,e.sent()]}})})},i=function(e){return new Promise(function(t){var n=new Image;n.src=e,n.onload=function(){var e=new OffscreenCanvas(n.width,n.height).getContext("2d");e.drawImage(n,0,0),t(e.getImageData(0,0,n.width,n.height))}})},o=function(e){return new Promise(function(t){var n=new FileReader;n.onload=function(e){var n=i(e.currentTarget.result);t(n)},n.readAsDataURL(e)})},c=void 0,u=function(e,t){var n=document.getElementById("canvas"),r=e.width-1,a=e.height;n.width=r,n.height=a;var i=n.getContext("2d"),o=i.createImageData(r,a);return o.data.set(t.subarray(0,r*a*4)),i.putImageData(o,0,0),o},s=function(e,t,n){c&&cancelAnimationFrame(c);var r=e.width,a=t.__retain(t.__allocArray(t.UINT8ARRAY_ID,e.data)),i=n?t.shrinkWidthWithForwardEnergy(a,r):t.shrinkWidth(a,r),o=t.__getUint8Array(i);e=u(e,o),t.__release(a),t.__release(i);var s,l=0,f=document.getElementById("canvasCaption");s=r/2,c=requestAnimationFrame(function n(){var r=t.shrink(),a=t.__getUint8Array(r);e=u(e,a),t.__release(r),f.innerHTML="Width reduced by "+l+++"px",l<s&&(c=requestAnimationFrame(n))})},l=function(){return e(void 0,void 0,void 0,function(){var n,r,c;return t(this,function(u){switch(u.label){case 0:return[4,new Promise(function(e){return window.addEventListener("load",e)})];case 1:return u.sent(),[4,a()];case 2:return n=u.sent(),c=!1,fetch("surfer-web.jpg").then(function(e){return e.arrayBuffer()}).then(function(e){var t=new Uint8Array(e),n=new Blob([t],{type:"image/jpeg"}),r=(window.URL||window.webkitURL).createObjectURL(n);return i(r)}).then(function(e){s(r=e,n,c)}),document.getElementById("originalFile").addEventListener("change",function(a){return e(void 0,void 0,void 0,function(){var e;return t(this,function(t){switch(t.label){case 0:return e=a.target.files,[4,o(e[0])];case 1:return r=t.sent(),s(r,n,c),[2]}})})}),document.getElementById("algo-classic").addEventListener("click",function(){s(r,n,c=!1)}),document.getElementById("algo-fwd").addEventListener("click",function(){s(r,n,c=!0)}),[2]}})})};l();
},{"@assemblyscript/loader":"k3Ah"}]},{},["QCba"], null)
//# sourceMappingURL=src.161c177f.js.map